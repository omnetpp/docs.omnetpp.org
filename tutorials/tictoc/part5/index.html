



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Docmentation for the OMNeT++ Simulator">
      
      
        <link rel="canonical" href="https://docs.omnetpp.org/tutorials/tictoc/part5/">
      
      
        <meta name="author" content="OMNeT++ Team">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.0">
    
    
      
        <title>Adding Statistics Collection - OMNeT++ Technical Articles</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.1b62728e.css">
      
      
    
    
    
      <script src="../../../assets/javascripts/modernizr.268332fc.js"></script>
    
    <script>
    // handle <a srcfile></a> references to source files
    document.addEventListener("DOMContentLoaded", function (event) {
        $('a[srcfile]').each(function(i) {
            var srcref = $(this).attr('srcfile');
            var name = srcref.replace(/.*\//g, "");
            $(this).text(name);
            $(this).attr('href', '/showfile/?url='+srcref);
            $(this).attr('target', '_blank');
        });
    });
    // function th show a full size image when clicked ona thumbnail
    imageFullSizeZoom = function(img){
        img = $(img);
        let fullSizeSrc = img.attr('src').replace(/.thumb.jpg$/, '.png');

        $(document.body).append(
        '<div class="fullscreenimgshade" onclick="$(this).remove();">' +
            '<img src="' + fullSizeSrc + '" class="fullscreenimg"/>' +
        '</div>'
        );
    };
    </script>

    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../../stylesheets/omnetpp-docs.css">
    
      <link rel="stylesheet" href="../../../stylesheets/rainbow.css">
    
      <link rel="stylesheet" href="../../../stylesheets/rainbow.linenumbers.theme.css">
    
      <link rel="stylesheet" href="../../../stylesheets/jupyter.css">
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-240922-2", "docs.omnetpp.org")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#part-5-adding-statistics-collection" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://docs.omnetpp.org/" title="OMNeT++ Technical Articles" class="md-header-nav__button md-logo">
          
            <i class="md-icon">î Œ</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              OMNeT++ Technical Articles
            </span>
            <span class="md-header-nav__topic">
              
                Adding Statistics Collection
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/omnetpp/docs.omnetpp.org/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    omnetpp/docs.omnetpp.org
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon md-icon--home"></i>
      
    </span>
    OMNeT++ Technical Articles
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/omnetpp/docs.omnetpp.org/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    omnetpp/docs.omnetpp.org
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
        
        
        


  <li class="md-nav__item">
    <a href="../../.." title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

      
    
      
        
        
        

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-1" type="checkbox" id="nav-2-1" checked>
    
    <label class="md-nav__link" for="nav-2-1">
      Learn OMNeT++ with TicToc
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-1">
        Learn OMNeT++ with TicToc
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../part1/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../part2/" title="Running the Simulation" class="md-nav__link">
      Running the Simulation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../part3/" title="Enhancing the 2-node TicToc" class="md-nav__link">
      Enhancing the 2-node TicToc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../part4/" title="Turning it Into a Real Network" class="md-nav__link">
      Turning it Into a Real Network
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Adding Statistics Collection
      </label>
    
    <a href="./" title="Adding Statistics Collection" class="md-nav__link md-nav__link--active">
      Adding Statistics Collection
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#51-displaying-the-number-of-packets-sentreceived" class="md-nav__link">
    5.1 Displaying the number of packets sent/received
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#52-adding-statistics-collection" class="md-nav__link">
    5.2 Adding statistics collection
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#53-statistic-collection-without-modifying-your-model" class="md-nav__link">
    5.3 Statistic collection without modifying your model
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#54-adding-figures" class="md-nav__link">
    5.4 Adding figures
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../part6/" title="Visualizing the Results" class="md-nav__link">
      Visualizing the Results
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../part7/" title="Parameter Studies" class="md-nav__link">
      Parameter Studies
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../conclusion/" title="Closing words" class="md-nav__link">
      Closing words
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pandas/" title="Result Analysis with Python" class="md-nav__link">
      Result Analysis with Python
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

      
    
      
        
        
        


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Articles
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Articles
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1" type="checkbox" id="nav-3-1">
    
    <label class="md-nav__link" for="nav-3-1">
      Introduction into Running Simulations in the Cloud
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-1">
        Introduction into Running Simulations in the Cloud
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cloud/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cloud/page1/" title="Concepts" class="md-nav__link">
      Concepts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cloud/page2/" title="Implementation" class="md-nav__link">
      Implementation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cloud/page4/" title="Deploying on AWS" class="md-nav__link">
      Deploying on AWS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cloud/page5/" title="Trying It Out" class="md-nav__link">
      Trying It Out
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cloud/page6/" title="Examining the Code" class="md-nav__link">
      Examining the Code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cloud/page7/" title="Potential Improvements, Alternatives" class="md-nav__link">
      Potential Improvements, Alternatives
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Using AWS for Running INET Simulation Campaigns
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Using AWS for Running INET Simulation Campaigns
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../swarm/" title="Motivation" class="md-nav__link">
      Motivation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../swarm/page1/" title="Installation and Usage" class="md-nav__link">
      Installation and Usage
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../swarm/page2/" title="How it Works" class="md-nav__link">
      How it Works
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../articles/porting-code-into-omnetpp/" title="Porting Real-World Protocol Implementations into OMNeT++" class="md-nav__link">
      Porting Real-World Protocol Implementations into OMNeT++
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../articles/building-omnetpp-in-docker/" title="Building an OMNeT++ Distro" class="md-nav__link">
      Building an OMNeT++ Distro
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../articles/running-omnetppgui-in-docker/" title="OMNeT++ GUI in Docker" class="md-nav__link">
      OMNeT++ GUI in Docker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../articles/running-omnetpp-in-docker/" title="Using Docker for Running Simulations on Various Versions of OMNeT++" class="md-nav__link">
      Using Docker for Running Simulations on Various Versions of OMNeT++
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../articles/wsl2/" title="Installing OMNeT++ on Windows Subsystem for Linux (WSL 2)" class="md-nav__link">
      Installing OMNeT++ on Windows Subsystem for Linux (WSL 2)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../articles/omnetpp-debugging-tips/" title="Improving the C++ Debugging Experience on Linux and other OSes" class="md-nav__link">
      Improving the C++ Debugging Experience on Linux and other OSes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

      
    
      
        
        
        


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Proposed Research Topics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Proposed Research Topics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../articles/neuralnet-errormodels/" title="Better Wireless Error Models Using Neural Networks" class="md-nav__link">
      Better Wireless Error Models Using Neural Networks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../articles/zero-conf-parsim/" title="Zero Configuration Automatic Parallel Simulation" class="md-nav__link">
      Zero Configuration Automatic Parallel Simulation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

      
    
      
    
      
    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#51-displaying-the-number-of-packets-sentreceived" class="md-nav__link">
    5.1 Displaying the number of packets sent/received
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#52-adding-statistics-collection" class="md-nav__link">
    5.2 Adding statistics collection
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#53-statistic-collection-without-modifying-your-model" class="md-nav__link">
    5.3 Statistic collection without modifying your model
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#54-adding-figures" class="md-nav__link">
    5.4 Adding figures
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/omnetpp/docs.omnetpp.org/edit/master/docs/tutorials/tictoc/part5.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="part-5-adding-statistics-collection">Part 5 - Adding Statistics Collection<a class="headerlink" href="#part-5-adding-statistics-collection" title="Permanent link">&para;</a></h1>
<h2 id="51-displaying-the-number-of-packets-sentreceived">5.1 Displaying the number of packets sent/received<a class="headerlink" href="#51-displaying-the-number-of-packets-sentreceived" title="Permanent link">&para;</a></h2>
<p>To get an overview at runtime how many messages each node sent or
received, we've added two counters to the module class: numSent and numReceived.</p>
<pre class="snippet" src="../code/txc14.cc" from="class Txc14" upto="protected:"></pre>

<p>They are set to zero and <code class="codehilite"><span class="err">WATCH</span></code>'ed in the <code class="codehilite"><span class="err">initialize()</span></code> method. Now we
can use the <em>Find/inspect</em> objects dialog (<em>Inspect</em> menu; it is also on
the toolbar) to learn how many packets were sent or received by the
various nodes.</p>
<p><img src="../images/step14a.png"></p>
<p>It's true that in this concrete simulation model the numbers will be
roughly the same, so you can only learn from them that <code class="codehilite"><span class="err">intuniform()</span></code>
works properly. But in real-life simulations it can be very useful that
you can quickly get an overview about the state of various nodes in the
model.</p>
<p>It can be also arranged that this info appears above the module
icons. The <code class="codehilite"><span class="err">t=</span></code> display string tag specifies the text;
we only need to modify the displays string during runtime.
The following code does the job:</p>
<pre class="snippet" src="../code/txc14.cc" from="void Txc14::refreshDisplay\(" upto="}"></pre>

<p>And the result looks like this:</p>
<p><img src="../images/step14b.png"></p>
<p>Sources: <a srcfile="tutorials/tictoc/code/tictoc14.ned"></a>, <a srcfile="tutorials/tictoc/code/tictoc14.msg"></a>, <a srcfile="tutorials/tictoc/code/txc14.cc"></a>, <a srcfile="tutorials/tictoc/code/omnetpp.ini"></a></p>
<h2 id="52-adding-statistics-collection">5.2 Adding statistics collection<a class="headerlink" href="#52-adding-statistics-collection" title="Permanent link">&para;</a></h2>
<p>The previous simulation model does something interesting enough
so that we can collect some statistics. For example, you may be interested
in the average hop count a message has to travel before reaching
its destination.</p>
<p>We'll record in the hop count of every message upon arrival into
an output vector (a sequence of (time,value) pairs, sort of a time series).
We also calculate mean, standard deviation, minimum, maximum values per node, and
write them into a file at the end of the simulation. Then we'll use
tools from the OMNeT++ IDE to analyse the output files.</p>
<p>For that, we add an output vector object (which will record the data into
<code class="codehilite"><span class="err">Tictoc15-#0.vec</span></code>) and a histogram object (which also calculates mean, etc)
to the class.</p>
<pre class="snippet" src="../code/txc15.cc" from="class Txc15" upto="protected:"></pre>

<p>When a message arrives at the destination node, we update the statistics.
The following code has been added to <code class="codehilite"><span class="err">handleMessage()</span></code>:</p>
<pre class="snippet" src="../code/txc15.cc" from="hopCountVector.record" upto="hopCountStats.collect"></pre>

<p>The <code class="codehilite"><span class="err">hopCountVector.record()</span></code> call writes the data into <code class="codehilite"><span class="err">Tictoc15-#0.vec</span></code>.
With a large simulation model or long execution time, the <code class="codehilite"><span class="err">Tictoc15-#0.vec</span></code> file
may grow very large. To handle this situation, you can specifically
disable/enable vector in omnetpp.ini, and you can also specify
a simulation time interval in which you're interested
(data recorded outside this interval will be discarded.)</p>
<p>When you begin a new simulation, the existing <code class="codehilite"><span class="err">Tictoc15-#0.vec/sca</span></code>
files get deleted.</p>
<p>Scalar data (collected by the histogram object in this simulation)
have to be recorded manually, in the <code class="codehilite"><span class="err">finish()</span></code> function.
<code class="codehilite"><span class="err">finish()</span></code> is invoked on successful completion of the simulation,
i.e. not when it's stopped with an error. The <code class="codehilite"><span class="err">recordScalar()</span></code> calls
in the code below write into the <code class="codehilite"><span class="err">Tictoc15-#0.sca</span></code> file.</p>
<pre class="snippet" src="../code/txc15.cc" from="::finish" upto="}"></pre>

<p>The files are stored in the <code class="codehilite"><span class="err">results/</span></code> subdirectory.</p>
<p>You can also view the data during simulation. To do that, right click on a module, and
choose <em>Open Details</em>. In the module inspector's <em>Contents</em> page you'll find the <code class="codehilite"><span class="err">hopCountStats</span></code>
and <code class="codehilite"><span class="err">hopCountVector</span></code> objects. To open their inspectors, right click on <code class="codehilite"><span class="err">cHistogram hopCountStats</span></code> or
<code class="codehilite"><span class="err">cOutVector HopCount</span></code>, and click <code class="codehilite"><span class="err">Open Graphical View</span></code>.</p>
<p><img src="../images/open_details.png"></p>
<p>The inspector:</p>
<p><img src="../images/open_graphical_view.png"></p>
<p>They will be initially empty -- run the simulation in <em>Fast</em> (or even <em>Express</em>)
mode to get enough data to be displayed. After a while you'll get something like this:</p>
<p><img src="../images/step15a.png"></p>
<p><img src="../images/step15b.png"></p>
<p>When you think enough data has been collected, you can stop the simulation
and then we'll analyse the result files (<code class="codehilite"><span class="err">Tictoc15-#0.vec</span></code> and
<code class="codehilite"><span class="err">Tictoc15-#0.sca</span></code>) off-line. You'll need to choose <em>Simulate -&gt; Call finish()</em>
from the menu (or click the corresponding toolbar button) before exiting --
this will cause the <code class="codehilite"><span class="err">finish()</span></code> functions to run and data to be written into
<code class="codehilite"><span class="err">Tictoc15-#0.sca</span></code>.</p>
<p>Sources: <a srcfile="tutorials/tictoc/code/tictoc15.ned"></a>, <a srcfile="tutorials/tictoc/code/tictoc15.msg"></a>, <a srcfile="tutorials/tictoc/code/txc15.cc"></a>, <a srcfile="tutorials/tictoc/code/omnetpp.ini"></a></p>
<h2 id="53-statistic-collection-without-modifying-your-model">5.3 Statistic collection without modifying your model<a class="headerlink" href="#53-statistic-collection-without-modifying-your-model" title="Permanent link">&para;</a></h2>
<p>In the previous step we have added statistic collection to our model.
While we can compute and save any value we wish, usually it is not known
at the time of writing the model, what data the enduser will need.</p>
<p>OMNeT++ provides an additional mechanism to record values and events.
Any model can emit <em>signals</em> that can carry a value or an object. The
model writer just have to decide what signals to emit, what data to attach
to them and when to emit them. The enduser can attach 'listeners' to these
signals that can process or record these data items. This way the model
code does not have to contain any code that is specific to the statistics
collection and the enduser can freely add additional statistics without
even looking into the C++ code.</p>
<p>We will re-write the statistic collection introduced in the last step to
use signals. First of all, we can safely remove all statistic related variables
from our module. There is no need for the <code class="codehilite"><span class="err">cOutVector</span></code> and
<code class="codehilite"><span class="err">cHistogram</span></code> classes either. We will need only a single signal
that carries the <code class="codehilite"><span class="err">hopCount</span></code> of the message at the time of message
arrival at the destination.</p>
<p>First we need to define our signal. The <code class="codehilite"><span class="err">arrivalSignal</span></code> is just an
identifier that can be used later to easily refer to our signal.</p>
<pre class="snippet" src="../code/txc16.cc" from="class Txc16" upto="protected:"></pre>

<p>We must register all signals before using them. The best place to do this
is the <code class="codehilite"><span class="err">initialize()</span></code> method of the module.</p>
<pre class="snippet" src="../code/txc16.cc" from="::initialize\(\)" upto="getIndex\(\)"></pre>

<p>Now we can emit our signal, when the message has arrived to the destination node.</p>
<pre class="snippet" src="../code/txc16.cc" from="::handleMessage\(" upto="EV"></pre>

<p>As we do not have to save or store anything manually, the <code class="codehilite"><span class="err">finish()</span></code> method
can be deleted. We no longer need it.</p>
<p>The last step is that we have to define the emitted signal also in the NED file.
Declaring signals in the NED file allows you to have all information about your
module in one place. You will see the parameters it takes, its input and output
gates, and also the signals and statistics it provides.</p>
<pre class="snippet" src="../code/tictoc16.ned" from="simple Txc16" upto="display"></pre>

<p>Now we can define also a statistic that should be collected by default. Our previous example
has collected statistics (max, min, mean, count, etc.) about the hop count of the
arriving messages, so let's collect the same data here, too.</p>
<p>The <code class="codehilite"><span class="err">source</span></code> key specifies the signal we want our statistic to attach to.
The <code class="codehilite"><span class="err">record</span></code> key can be used to tell what should be done with the received
data. In our case we specify that each value must be saved in a vector file (vector)
and also we need to calculate min,max,mean,count etc. (stats). (NOTE: <code class="codehilite"><span class="err">stats</span></code> is
just a shorthand for min, max, mean, sum, count, etc.) With this step we have finished
our model.</p>
<p>Now we have just realized that we would like to see a histogram of the <code class="codehilite"><span class="err">hopCount</span></code> on the
<code class="codehilite"><span class="err">tic[1]</span></code> module. On the other hand we are short on disk storage and we are not interested
having the vector data for the first three module <code class="codehilite"><span class="err">tic</span></code> 0,1,2. No problem. We can add our
histogram and remove the unneeded vector recording without even touching the C++ or NED
files. Just open the INI file and modify the statistic recording:</p>
<pre class="snippet" src="../code/omnetpp.ini" from="\[Tictoc16\]" upto="tic\[0..2\]"></pre>

<p>We can configure a wide range of statistics without even looking into the C++ code,
provided that the original model emits the necessary signals for us.</p>
<p>Sources: <a srcfile="tutorials/tictoc/code/tictoc16.ned"></a>, <a srcfile="tutorials/tictoc/code/tictoc16.msg"></a>, <a srcfile="tutorials/tictoc/code/txc16.cc"></a>, <a srcfile="tutorials/tictoc/code/omnetpp.ini"></a></p>
<h2 id="54-adding-figures">5.4 Adding figures<a class="headerlink" href="#54-adding-figures" title="Permanent link">&para;</a></h2>
<p>OMNeT++ can display figures on the canvas, such as text, geometric shapes or images.
These figures can be static, or change dynamically according to what happens in the simulation.
In this case, we will display a static descriptive text, and a dynamic text showing the hop count of the last message that arrived at its destination.</p>
<p>We create figures in <a srcfile="tutorials/tictoc/code/tictoc17.ned"></a>, with the <code class="codehilite"><span class="err">@figure</span></code> property.</p>
<pre class="snippet" src="../code/tictoc17.ned" from="network Tictoc17" upto="lasthopcount"></pre>

<p>This creates two text figures named <code class="codehilite"><span class="err">description</span></code> and <code class="codehilite"><span class="err">lasthopcount</span></code>, and sets their positions on the canvas (we place them in the top right corner).
The <code class="codehilite"><span class="err">font</span></code> attribute sets the figure text's font. It has three parameters: <code class="codehilite"><span class="err">typeface, size, style</span></code>. Any one of them
can be omitted to leave the parameter at default. Here we set the description figure's font to bold.</p>
<p>By default the text in <code class="codehilite"><span class="err">lasthopcount</span></code> is static, but we'll
change it when a message arrives. This is done in <a srcfile="tutorials/tictoc/code/txc17.cc"></a>, in the <code class="codehilite"><span class="err">handleMessage()</span></code> function.</p>
<pre class="snippet" src="../code/txc17.cc" from="hasGUI" upto="setText"></pre>

<p>The figure is represented by the <code class="codehilite"><span class="err">cTextFigure</span></code> C++ class. There are several figure types,
all of them are subclassed from the <code class="codehilite"><span class="err">cFigure</span></code> base class.
We insert the code responsible for updating the figure text after we retreive the <code class="codehilite"><span class="err">hopcount</span></code> variable.</p>
<p>We want to draw the figures on the network's canvas. The <code class="codehilite"><span class="err">getParentModule()</span></code> function returns the parent of the node, ie. the network.
Then the <code class="codehilite"><span class="err">getCanvas()</span></code> function returns the network's canvas, and <code class="codehilite"><span class="err">getFigure()</span></code> gets the figure by name.
Then, we update the figure's text with the <code class="codehilite"><span class="err">setText()</span></code> function.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>For more information on figures and the canvas, see <a href="https://doc.omnetpp.org/omnetpp/manual/index.html#sec:graphics:canvas" target="_blank">The Canvas</a> section of the OMNeT++ manual</p>
</div>
<p>When you run the simulation, the figure displays 'last hopCount: N/A' before the arrival of the first message.
Then, it is updated whenever a message arrives at its destination.</p>
<p><img src="../images/step17.png"></p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If the figure text and nodes overlap, press 're-layout'.
<img src="../images/relayout.png"></p>
</div>
<p>In the last few steps, we have collected and displayed statistics. In the next part,
we'll see and analyze them in the IDE.</p>
<p>Sources: <a srcfile="tutorials/tictoc/code/tictoc17.ned"></a>, <a srcfile="tutorials/tictoc/code/tictoc17.msg"></a>, <a srcfile="tutorials/tictoc/code/txc17.cc"></a>, <a srcfile="tutorials/tictoc/code/omnetpp.ini"></a></p>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../part4/" title="Turning it Into a Real Network" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Turning it Into a Real Network
              </span>
            </div>
          </a>
        
        
          <a href="../part6/" title="Visualizing the Results" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Visualizing the Results
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2019 OpenSim Ltd.
          </div>
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../../assets/fonts/font-awesome.css">
    
      <a href="http://omnetpp.org" class="md-footer-social__link fa fa-globe"></a>
    
      <a href="https://github.com/omnetpp/docs.omnetpp.org" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/omnetpp" class="md-footer-social__link fa fa-twitter"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.808e90bb.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script>
      
        <script src="../../../javascripts/jquery-3.2.1.min.js"></script>
      
        <script src="../../../javascripts/quoting.js"></script>
      
        <script src="../../../javascripts/rainbow-custom.min.js"></script>
      
        <script src="../../../javascripts/rainbow.linenumbers.min.js"></script>
      
        <script src="../../../javascripts/rainbow-ini.js"></script>
      
        <script src="../../../javascripts/rainbow-ned.js"></script>
      
        <script src="../../../javascripts/rainbow-yaml.js"></script>
      
        <script src="../../../javascripts/rainbow-dockerfile.js"></script>
      
        <script src="../../../javascripts/rainbow-html.js"></script>
      
    
  </body>
</html>