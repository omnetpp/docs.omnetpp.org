



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Docmentation for the OMNeT++ Simulator">
      
      
        <link rel="canonical" href="https://docs.omnetpp.org/tutorials/tictoc/part3/">
      
      
        <meta name="author" content="OMNeT++ Team">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.0">
    
    
      
        <title>Enhancing the 2-node TicToc - OMNeT++ Technical Articles</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.1b62728e.css">
      
      
    
    
    
      <script src="../../../assets/javascripts/modernizr.268332fc.js"></script>
    
    <script>
    // handle <a srcfile></a> references to source files
    document.addEventListener("DOMContentLoaded", function (event) {
        $('a[srcfile]').each(function(i) {
            var srcref = $(this).attr('srcfile');
            var name = srcref.replace(/.*\//g, "");
            $(this).text(name);
            $(this).attr('href', '/showfile/?url='+srcref);
            $(this).attr('target', '_blank');
        });
    });
    // function th show a full size image when clicked ona thumbnail
    imageFullSizeZoom = function(img){
        img = $(img);
        let fullSizeSrc = img.attr('src').replace(/.thumb.jpg$/, '.png');

        $(document.body).append(
        '<div class="fullscreenimgshade" onclick="$(this).remove();">' +
            '<img src="' + fullSizeSrc + '" class="fullscreenimg"/>' +
        '</div>'
        );
    };
    </script>

    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../../stylesheets/omnetpp-docs.css">
    
      <link rel="stylesheet" href="../../../stylesheets/rainbow.css">
    
      <link rel="stylesheet" href="../../../stylesheets/rainbow.linenumbers.theme.css">
    
      <link rel="stylesheet" href="../../../stylesheets/jupyter.css">
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-240922-2", "docs.omnetpp.org")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#part-3-enhancing-the-2-node-tictoc" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://docs.omnetpp.org/" title="OMNeT++ Technical Articles" class="md-header-nav__button md-logo">
          
            <i class="md-icon">î Œ</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              OMNeT++ Technical Articles
            </span>
            <span class="md-header-nav__topic">
              
                Enhancing the 2-node TicToc
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/omnetpp/docs.omnetpp.org/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    omnetpp/docs.omnetpp.org
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon md-icon--home"></i>
      
    </span>
    OMNeT++ Technical Articles
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/omnetpp/docs.omnetpp.org/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    omnetpp/docs.omnetpp.org
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
        
        
        


  <li class="md-nav__item">
    <a href="../../.." title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

      
    
      
        
        
        

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-1" type="checkbox" id="nav-2-1" checked>
    
    <label class="md-nav__link" for="nav-2-1">
      Learn OMNeT++ with TicToc
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-1">
        Learn OMNeT++ with TicToc
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../part1/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../part2/" title="Running the Simulation" class="md-nav__link">
      Running the Simulation
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Enhancing the 2-node TicToc
      </label>
    
    <a href="./" title="Enhancing the 2-node TicToc" class="md-nav__link md-nav__link--active">
      Enhancing the 2-node TicToc
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#31-adding-icons" class="md-nav__link">
    3.1 Adding icons
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#32-adding-logging" class="md-nav__link">
    3.2 Adding logging
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#33-adding-state-variables" class="md-nav__link">
    3.3 Adding state variables
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#34-adding-parameters" class="md-nav__link">
    3.4 Adding parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#35-using-ned-inheritance" class="md-nav__link">
    3.5 Using NED inheritance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#36-modeling-processing-delay" class="md-nav__link">
    3.6 Modeling processing delay
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#37-random-numbers-and-parameters" class="md-nav__link">
    3.7 Random numbers and parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#38-timeout-cancelling-timers" class="md-nav__link">
    3.8 Timeout, cancelling timers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#39-retransmitting-the-same-message" class="md-nav__link">
    3.9 Retransmitting the same message
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../part4/" title="Turning it Into a Real Network" class="md-nav__link">
      Turning it Into a Real Network
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../part5/" title="Adding Statistics Collection" class="md-nav__link">
      Adding Statistics Collection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../part6/" title="Visualizing the Results" class="md-nav__link">
      Visualizing the Results
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../part7/" title="Parameter Studies" class="md-nav__link">
      Parameter Studies
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../conclusion/" title="Closing words" class="md-nav__link">
      Closing words
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pandas/" title="Result Analysis with Python" class="md-nav__link">
      Result Analysis with Python
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

      
    
      
        
        
        


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Articles
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Articles
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1" type="checkbox" id="nav-3-1">
    
    <label class="md-nav__link" for="nav-3-1">
      Introduction into Running Simulations in the Cloud
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-1">
        Introduction into Running Simulations in the Cloud
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cloud/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cloud/page1/" title="Concepts" class="md-nav__link">
      Concepts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cloud/page2/" title="Implementation" class="md-nav__link">
      Implementation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cloud/page4/" title="Deploying on AWS" class="md-nav__link">
      Deploying on AWS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cloud/page5/" title="Trying It Out" class="md-nav__link">
      Trying It Out
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cloud/page6/" title="Examining the Code" class="md-nav__link">
      Examining the Code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cloud/page7/" title="Potential Improvements, Alternatives" class="md-nav__link">
      Potential Improvements, Alternatives
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Using AWS for Running INET Simulation Campaigns
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Using AWS for Running INET Simulation Campaigns
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../swarm/" title="Motivation" class="md-nav__link">
      Motivation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../swarm/page1/" title="Installation and Usage" class="md-nav__link">
      Installation and Usage
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../swarm/page2/" title="How it Works" class="md-nav__link">
      How it Works
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../articles/porting-code-into-omnetpp/" title="Porting Real-World Protocol Implementations into OMNeT++" class="md-nav__link">
      Porting Real-World Protocol Implementations into OMNeT++
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../articles/building-omnetpp-in-docker/" title="Building an OMNeT++ Distro" class="md-nav__link">
      Building an OMNeT++ Distro
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../articles/running-omnetppgui-in-docker/" title="OMNeT++ GUI in Docker" class="md-nav__link">
      OMNeT++ GUI in Docker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../articles/running-omnetpp-in-docker/" title="Using Docker for Running Simulations on Various Versions of OMNeT++" class="md-nav__link">
      Using Docker for Running Simulations on Various Versions of OMNeT++
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../articles/wsl2/" title="Installing OMNeT++ on Windows Subsystem for Linux (WSL 2)" class="md-nav__link">
      Installing OMNeT++ on Windows Subsystem for Linux (WSL 2)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../articles/omnetpp-debugging-tips/" title="Improving the C++ Debugging Experience on Linux and other OSes" class="md-nav__link">
      Improving the C++ Debugging Experience on Linux and other OSes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

      
    
      
        
        
        


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Proposed Research Topics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Proposed Research Topics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../articles/neuralnet-errormodels/" title="Better Wireless Error Models Using Neural Networks" class="md-nav__link">
      Better Wireless Error Models Using Neural Networks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../articles/zero-conf-parsim/" title="Zero Configuration Automatic Parallel Simulation" class="md-nav__link">
      Zero Configuration Automatic Parallel Simulation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

      
    
      
    
      
    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#31-adding-icons" class="md-nav__link">
    3.1 Adding icons
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#32-adding-logging" class="md-nav__link">
    3.2 Adding logging
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#33-adding-state-variables" class="md-nav__link">
    3.3 Adding state variables
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#34-adding-parameters" class="md-nav__link">
    3.4 Adding parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#35-using-ned-inheritance" class="md-nav__link">
    3.5 Using NED inheritance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#36-modeling-processing-delay" class="md-nav__link">
    3.6 Modeling processing delay
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#37-random-numbers-and-parameters" class="md-nav__link">
    3.7 Random numbers and parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#38-timeout-cancelling-timers" class="md-nav__link">
    3.8 Timeout, cancelling timers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#39-retransmitting-the-same-message" class="md-nav__link">
    3.9 Retransmitting the same message
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/omnetpp/docs.omnetpp.org/edit/master/docs/tutorials/tictoc/part3.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="part-3-enhancing-the-2-node-tictoc">Part 3 - Enhancing the 2-node TicToc<a class="headerlink" href="#part-3-enhancing-the-2-node-tictoc" title="Permanent link">&para;</a></h1>
<h2 id="31-adding-icons">3.1 Adding icons<a class="headerlink" href="#31-adding-icons" title="Permanent link">&para;</a></h2>
<p>Here we make the model look a bit prettier in the GUI. We assign
the <code class="codehilite"><span class="err">block/routing</span></code> icon (the file <code class="codehilite"><span class="err">images/block/routing.png</span></code>), and paint it cyan for <code class="codehilite"><span class="err">tic</span></code>
and yellow for <code class="codehilite"><span class="err">toc</span></code>. This is achieved by adding display strings to the
NED file. The <code class="codehilite"><span class="err">i=</span></code> tag in the display string specifies the icon.</p>
<pre class="snippet" src="../code/tictoc2.ned" from="simple Txc2" upto="toc.out;\n}"></pre>

<p>You can see the result here:</p>
<p><img src="../images/step2a.png"></p>
<h2 id="32-adding-logging">3.2 Adding logging<a class="headerlink" href="#32-adding-logging" title="Permanent link">&para;</a></h2>
<p>We also modify the C++ code. We add log statements to <code class="codehilite"><span class="err">Txc1</span></code> so that it
prints what it is doing. OMNeT++ provides a sophisticated logging facility
with log levels, log channels, filtering, etc. that are useful for large
and complex models, but in this model we'll use its simplest form <code class="codehilite"><span class="err">EV</span></code>:</p>
<pre class="snippet" src="../code/txc2.cc" from="EV" until="cMessage"></pre>

<p>and</p>
<pre class="snippet" src="../code/txc2.cc" after="here it will be" upto="EV"></pre>

<p>When you run the simulation in the OMNeT++ runtime environment, the following output
will appear in the log window:</p>
<p><img src="../images/step2b.png"></p>
<p>You can also open separate output windows for <em>tic</em> and <em>toc</em> by right-clicking
on their icons and choosing <em>Component log</em> from the menu. This feature
will be useful when you have a large model ("fast scrolling logs syndrome")
and you're interested only in the log messages of specific module.</p>
<p><img src="../images/step2c.png"></p>
<p>Sources: <a srcfile="tutorials/tictoc/code/tictoc2.ned"></a>, <a srcfile="tutorials/tictoc/code/txc2.cc"></a>, <a srcfile="tutorials/tictoc/code/omnetpp.ini"></a></p>
<h2 id="33-adding-state-variables">3.3 Adding state variables<a class="headerlink" href="#33-adding-state-variables" title="Permanent link">&para;</a></h2>
<p>In this step we add a counter to the module, and delete the message
after ten exchanges.</p>
<p>We add the counter as a class member:</p>
<pre class="snippet" src="../code/txc3.cc" from="class Txc3" upto="protected"></pre>

<p>We set the variable to 10 in <code class="codehilite"><span class="err">initialize()</span></code> and decrement in <code class="codehilite"><span class="err">handleMessage()</span></code>,
that is, on every message arrival. After it reaches zero, the simulation
will run out of events and terminate.</p>
<p>Note the</p>
<pre class="snippet" src="../code/txc3.cc" after="bottom left" upto="WATCH"></pre>

<p>line in the source: this makes it possible to see the counter value
in the graphical runtime environment.</p>
<p>If you click on <code class="codehilite"><span class="err">tic</span></code>'s icon, the inspector window in the bottom left corner of the main window will display
details about <code class="codehilite"><span class="err">tic</span></code>. Make sure that <em>Children</em> mode is selected from the toolbar at the top.
The inspector now displays the counter variable.</p>
<p><img src="../images/inspector.png"></p>
<p>As you continue running the simulation, you can follow as the counter
keeps decrementing until it reaches zero.</p>
<p>Sources: <a srcfile="tutorials/tictoc/code/tictoc3.ned"></a>, <a srcfile="tutorials/tictoc/code/txc3.cc"></a>, <a srcfile="tutorials/tictoc/code/omnetpp.ini"></a></p>
<h2 id="34-adding-parameters">3.4 Adding parameters<a class="headerlink" href="#34-adding-parameters" title="Permanent link">&para;</a></h2>
<p>In this step you'll learn how to add input parameters to the simulation:
we'll turn the "magic number" 10 into a parameter and add a boolean parameter
to decide whether the module should send out the first message in its
initialization code (whether this is a <code class="codehilite"><span class="err">tic</span></code> or a <code class="codehilite"><span class="err">toc</span></code> module).</p>
<p>Module parameters have to be declared in the NED file. The data type can
be numeric, string, bool, or xml (the latter is for easy access to
XML config files), among others.</p>
<pre class="snippet" src="../code/tictoc4.ned" from="simple Txc4" upto="gates"></pre>

<p>We also have to modify the C++ code to read the parameter in
<code class="codehilite"><span class="err">initialize()</span></code>, and assign it to the counter.</p>
<pre class="snippet" src="../code/txc4.cc" after="in the NED file" upto="counter"></pre>

<p>We can use the second parameter to decide whether to send initial message:</p>
<pre class="snippet" src="../code/txc4.cc" after="whether to send" upto="par\("></pre>

<p>Now, we can assign the parameters in the NED file or from <code class="codehilite"><span class="err">omnetpp.ini</span></code>.
Assignments in the NED file take precedence. You can define default
values for parameters if you use the <code class="codehilite"><span class="err">default(...)</span></code> syntax
in the NED file. In this case you can either set the value of the
parameter in omnetpp.ini or use the default value provided by the NED file.</p>
<p>Here, we assign one parameter in the NED file:</p>
<pre class="snippet" src="../code/tictoc4.ned" from="network Tictoc4" upto="connections"></pre>

<p>and the other in <code class="codehilite"><span class="err">omnetpp.ini</span></code>:</p>
<pre class="snippet" src="../code/omnetpp.ini" after="network = Tictoc4" upto="Tictoc4.toc"></pre>

<p>Note that because omnetpp.ini supports wildcards, and parameters
assigned from NED files take precedence over the ones in omnetpp.ini,
we could have used</p>
<div class="codehilite"><pre><span></span><span class="err">Tictoc4.t*c.limit=5</span>
</pre></div>

<p>or</p>
<div class="codehilite"><pre><span></span><span class="err">Tictoc4.*.limit=5</span>
</pre></div>

<p>or even</p>
<div class="codehilite"><pre><span></span><span class="err">**.limit=5</span>
</pre></div>

<p>with the same effect. (The difference between <code class="codehilite"><span class="err">*</span></code> and <code class="codehilite"><span class="err">**</span></code> is that <code class="codehilite"><span class="err">*</span></code> will not match
a dot and <code class="codehilite"><span class="err">**</span></code> will.)</p>
<p>In the graphical runtime environment, you can inspect module parameters either in the object tree
on the left-hand side of the main window, or in the Parameters page of
the module inspector (information is shown in the bottom left corner of the main window after
clicking on a module).</p>
<p>The module with the smaller limit will delete the message and thereby
conclude the simulation.</p>
<p>Sources: <a srcfile="tutorials/tictoc/code/tictoc4.ned"></a>, <a srcfile="tutorials/tictoc/code/txc4.cc"></a>, <a srcfile="tutorials/tictoc/code/omnetpp.ini"></a></p>
<h2 id="35-using-ned-inheritance">3.5 Using NED inheritance<a class="headerlink" href="#35-using-ned-inheritance" title="Permanent link">&para;</a></h2>
<p>If we take a closer look at the NED file we will realize that <code class="codehilite"><span class="err">tic</span></code>
and <code class="codehilite"><span class="err">toc</span></code> differs only in their parameter values and their display string.
We can create a new simple module type by inheriting from an other one and specifying
or overriding some of its parameters. In our case we will derive two simple
module types (<code class="codehilite"><span class="err">Tic</span></code> and <code class="codehilite"><span class="err">Toc</span></code>). Later we can use these types when defining
the submodules in the network.</p>
<p>Deriving from an existing simple module is easy. Here is the base module:</p>
<pre class="snippet" src="../code/tictoc5.ned" from="simple Txc5" upto="}"></pre>

<p>And here is the derived module. We just simply specify the parameter values and add some
display properties.</p>
<pre class="snippet" src="../code/tictoc5.ned" from="simple Tic5" upto="}"></pre>

<p>The <code class="codehilite"><span class="err">Toc</span></code> module looks similar, but with different parameter values.</p>
<pre class="snippet" src="../code/tictoc5.ned" from="simple Toc5" upto="}"></pre>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The C++ implementation is inherited from the base simple module (<code class="codehilite"><span class="err">Txc5</span></code>).</p>
</div>
<p>Once we created the new simple modules, we can use them as submodule types in our network:</p>
<pre class="snippet" src="../code/tictoc5.ned" from="network" upto="connections"></pre>

<p>As you can see, the network definition is much shorter and simpler now.
Inheritance allows you to use common types in your network and avoid
redundant definitions and parameter settings.</p>
<h2 id="36-modeling-processing-delay">3.6 Modeling processing delay<a class="headerlink" href="#36-modeling-processing-delay" title="Permanent link">&para;</a></h2>
<p>In the previous models, <code class="codehilite"><span class="err">tic</span></code> and <code class="codehilite"><span class="err">toc</span></code> immediately sent back the
received message. Here we'll add some timing: <code class="codehilite"><span class="err">tic</span></code> and <code class="codehilite"><span class="err">toc</span></code> will hold the
message for 1 simulated second before sending it back. In OMNeT++
such timing is achieved by the module sending a message to itself.
Such messages are called self-messages (but only because of the way they
are used, otherwise they are ordinary message objects).</p>
<p>We added two cMessage * variables, <code class="codehilite"><span class="err">event</span></code> and <code class="codehilite"><span class="err">tictocMsg</span></code>
to the class, to remember the message we use for timing and message whose
processing delay we are simulating.</p>
<pre class="snippet" src="../code/txc6.cc" from="class Txc6" upto="public"></pre>

<p>We "send" the self-messages with the scheduleAt() function, specifying
when it should be delivered back to the module.</p>
<pre class="snippet" src="../code/txc6.cc" after="tictocMsg = msg;" upto="scheduleAt\("></pre>

<p>In <code class="codehilite"><span class="err">handleMessage()</span></code> now we have to differentiate whether a new message
has arrived via the input gate or the self-message came back
(timer expired). Here we are using</p>
<pre class="snippet" src="../code/txc6.cc" after="method" upto="if \(msg == event\) \{"></pre>

<p>but we could have written</p>
<div class="codehilite"><pre><span></span><span class="err">    if (msg-&gt;isSelfMessage())</span>
</pre></div>

<p>as well.</p>
<p>We have left out the counter, to keep the source code small.</p>
<p>While running the simulation you will see the following log output:</p>
<p><img src="../images/step6.png"></p>
<p>Sources: <a srcfile="tutorials/tictoc/code/tictoc6.ned"></a>, <a srcfile="tutorials/tictoc/code/txc6.cc"></a>, <a srcfile="tutorials/tictoc/code/omnetpp.ini"></a></p>
<h2 id="37-random-numbers-and-parameters">3.7 Random numbers and parameters<a class="headerlink" href="#37-random-numbers-and-parameters" title="Permanent link">&para;</a></h2>
<p>In this step we'll introduce random numbers. We change the delay from 1s
to a random value which can be set from the NED file or from omnetpp.ini.
Module parameters are able to return random variables; however, to make
use of this feature we have to read the parameter in <code class="codehilite"><span class="err">handleMessage()</span></code>
every time we use it.</p>
<pre class="snippet" src="../code/txc7.cc" from="module parameter" until="scheduleAt\("></pre>

<p>In addition, we'll "lose" (delete) the packet with a small (hardcoded) probability.</p>
<pre class="snippet" src="../code/txc7.cc" from="uniform\(" upto="}"></pre>

<p>We'll assign the parameters in omnetpp.ini:</p>
<pre class="snippet" src="../code/omnetpp.ini" from="Tictoc7.t" upto="Tictoc7.t"></pre>

<p>You can try that no matter how many times you re-run the simulation (or
restart it, <em>Simulate -&gt; Rebuild network</em> menu item), you'll get exactly the
same results. This is because OMNeT++ uses a deterministic algorithm
(by default the Mersenne Twister RNG) to generate random numbers, and
initializes it to the same seed. This is important for reproducible
simulations. You can experiment with different seeds if you add the
following lines to omnetpp.ini:</p>
<div class="codehilite"><pre><span></span><span class="k">[General]</span>
<span class="na">seed-0-mt</span><span class="o">=</span><span class="s">532569  # or any other 32-bit value</span>
</pre></div>

<p>From the syntax you have probably guessed that OMNeT++ supports
more than one RNGs. That's right, however, all models in this tutorial
use RNG 0.</p>
<div class="admonition tip">
<p class="admonition-title">Exercise</p>
<p>Try other distributions as well.</p>
</div>
<p>Sources: <a srcfile="tutorials/tictoc/code/tictoc7.ned"></a>, <a srcfile="tutorials/tictoc/code/txc7.cc"></a>, <a srcfile="tutorials/tictoc/code/omnetpp.ini"></a></p>
<h2 id="38-timeout-cancelling-timers">3.8 Timeout, cancelling timers<a class="headerlink" href="#38-timeout-cancelling-timers" title="Permanent link">&para;</a></h2>
<p>In order to get one step closer to modelling networking protocols,
let us transform our model into a stop-and-wait simulation.
This time we'll have separate classes for <code class="codehilite"><span class="err">tic</span></code> and <code class="codehilite"><span class="err">toc</span></code>. The basic
scenario is similar to the previous ones: <code class="codehilite"><span class="err">tic</span></code> and <code class="codehilite"><span class="err">toc</span></code> will be tossing a
message to one another. However, <code class="codehilite"><span class="err">toc</span></code> will "lose" the message with some
nonzero probability, and in that case <code class="codehilite"><span class="err">tic</span></code> will have to resend it.</p>
<p>Here's <code class="codehilite"><span class="err">toc</span></code>'s code:</p>
<pre class="snippet" src="../code/txc8.cc" from="void Toc8" upto="else"></pre>

<p>Thanks to the <code class="codehilite"><span class="err">bubble()</span></code> call in the code, <code class="codehilite"><span class="err">toc</span></code> will display a callout whenever
it drops the message.</p>
<p><img src="../images/step8.png"></p>
<p>So, <code class="codehilite"><span class="err">tic</span></code> will start a timer whenever it sends the message. When
the timer expires, we'll assume the message was lost and send another
one. If <code class="codehilite"><span class="err">toc</span></code>'s reply arrives, the timer has to be cancelled.
The timer will be (what else?) a self-message.</p>
<pre class="snippet" src="../code/txc8.cc" after="send\(newMsg" upto="scheduleAt\("></pre>

<p>Cancelling the timer will be done with the <code class="codehilite"><span class="err">cancelEvent()</span></code> call. Note that
this does not prevent us from being able to reuse the same
timeout message over and over.</p>
<pre class="snippet" src="../code/txc8.cc" after="Timer cancelled." upto="cancelEvent\("></pre>

<p>You can read Tic's full source in <a srcfile="tutorials/tictoc/code/txc8.cc"></a></p>
<p>Sources: <a srcfile="tutorials/tictoc/code/tictoc8.ned"></a>, <a srcfile="tutorials/tictoc/code/txc8.cc"></a>, <a srcfile="tutorials/tictoc/code/omnetpp.ini"></a></p>
<h2 id="39-retransmitting-the-same-message">3.9 Retransmitting the same message<a class="headerlink" href="#39-retransmitting-the-same-message" title="Permanent link">&para;</a></h2>
<p>In this step we refine the previous model.
There we just created another packet if we needed to
retransmit. This is OK because the packet didn't contain much, but
in real life it's usually more practical to keep a copy of the original
packet so that we can re-send it without the need to build it again.
Keeping a pointer to the sent message - so we can send it again - might seem easier,
but when the message is destroyed at the other node the pointer becomes invalid.</p>
<p>What we do here is keep the original packet and send only copies of it.
We delete the original when <code class="codehilite"><span class="err">toc</span></code>'s acknowledgement arrives.
To make it easier to visually verify the model, we'll include a message
sequence number in the message names.</p>
<p>In order to avoid <code class="codehilite"><span class="err">handleMessage()</span></code> growing too large, we'll put the
corresponding code into two new functions, <code class="codehilite"><span class="err">generateNewMessage()</span></code>
and <code class="codehilite"><span class="err">sendCopyOf()</span></code> and call them from <code class="codehilite"><span class="err">handleMessage()</span></code>.</p>
<p>The functions:</p>
<pre class="snippet" src="../code/txc9.cc" from="cMessage \*Tic9" upto="return msg;\n}"></pre>

<pre class="snippet" src="../code/txc9.cc" from="void Tic9::sendCopyOf" upto="\)\;\n\}"></pre>

<p>Sources: <a srcfile="tutorials/tictoc/code/tictoc9.ned"></a>, <a srcfile="tutorials/tictoc/code/txc9.cc"></a>, <a srcfile="tutorials/tictoc/code/omnetpp.ini"></a></p>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../part2/" title="Running the Simulation" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Running the Simulation
              </span>
            </div>
          </a>
        
        
          <a href="../part4/" title="Turning it Into a Real Network" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Turning it Into a Real Network
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2019 OpenSim Ltd.
          </div>
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../../assets/fonts/font-awesome.css">
    
      <a href="http://omnetpp.org" class="md-footer-social__link fa fa-globe"></a>
    
      <a href="https://github.com/omnetpp/docs.omnetpp.org" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/omnetpp" class="md-footer-social__link fa fa-twitter"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.808e90bb.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script>
      
        <script src="../../../javascripts/jquery-3.2.1.min.js"></script>
      
        <script src="../../../javascripts/quoting.js"></script>
      
        <script src="../../../javascripts/rainbow-custom.min.js"></script>
      
        <script src="../../../javascripts/rainbow.linenumbers.min.js"></script>
      
        <script src="../../../javascripts/rainbow-ini.js"></script>
      
        <script src="../../../javascripts/rainbow-ned.js"></script>
      
        <script src="../../../javascripts/rainbow-yaml.js"></script>
      
        <script src="../../../javascripts/rainbow-dockerfile.js"></script>
      
        <script src="../../../javascripts/rainbow-html.js"></script>
      
    
  </body>
</html>